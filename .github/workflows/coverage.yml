name: Post coverage comment

on:
  workflow_call:

jobs:
  test:
    name: "Run tests & display coverage"
    runs-on: ubuntu-latest
    permissions:
      pull-requests: write
      contents: write # needed to edit the comment vs opening multiple ones
      actions: read
    steps:
      - name: "Download coverage data ðŸ“¥"
        uses: actions/download-artifact@v4
        with:
          pattern: coverage-data-*
          merge-multiple: true
      - name: "Post coverage comment"
        uses: py-cov-action/python-coverage-comment-action@v3
        with:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          GITHUB_PR_RUN_ID: ${{ github.event.workflow_run.id }}
